<!DOCTYPE html>

<html lang="ko" xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout/default}">

<head>
<title>[[#{left.008}]]</title>

</head>
<div layout:fragment="content">
	<div class="card mb-3">
		<div class="bg-holder d-none d-lg-block bg-card"
			style="background-image: url(/assets/img/illustrations/corner-4.png);">
		</div>
		<div class="card-body">
			<div class="row flex-between-center">
				<div class="col-sm-auto mb-2 mb-sm-0">
					<h4 class="mb-0 title-area" data-anchor="data-anchor" id="tooltips">[[#{left.008}]]</h4>
				</div>
				<div class="col-sm-auto">
					<div class="row gx-2 align-items-center">
						<div class="col-auto">
							<select id="projectNameItemDropdown" class="form-select picker"
								data-live-search="true">
								<option value="">[[#{select.project.select}]]</option>
							</select>
						</div>
						<div class="col-auto">
							<select id="regdtimDropdown" class="form-select picker"
								data-live-search="true">
								<option value="">[[#{select.perform.select}]]</option>
							</select>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<div class="card mb-3">
		<div class="card-body">
			<div class="tab-pane preview-tab-pane active" role="tabpanel"
				aria-labelledby="tab-dom-28a0c0e7-4d81-45ea-b108-f94c2e55ef9c"
				id="dom-28a0c0e7-4d81-45ea-b108-f94c2e55ef9c">
				<table
					class="table table-sm table-striped fs--1 mb-0 overflow-hidden"
					id="table">
				</table>
			</div>
		</div>
	</div>

	<script type="text/javascript">
		var $table = $('#table');
		var $projectNameItemDropdown = $("#projectNameItemDropdown");
		var $regdtItemDropdown = $("#regdtimDropdown");
		var paramData = {};
		$(function() {
			paramData = jsonParse('[[${paramData}]]');
			
			fn_projectNames();
			fn_Table();
			fn_Event();
		});

		function fn_projectNames() {
			var param = {
				target : "PROJECT_NAMES",
				url : "/result/projectnames/",
				isLoading : false
			}
			ajaxCall(param);
		}

		function fn_regdtItems(projectName) {
			var param = {
				target : "REGDT_ITEMS",
				url : "/resultitem/" + projectName + "/regdtim/",
				isLoading : false
			}
			ajaxCall(param);
		}

		function fn_Event() {

		}

		function fn_Table() {
			$table.bootstrapTable('destroy').bootstrapTable({
				theadClasses : 'bg-200 text-900',
				height : 650,
				pageSize : "20",
				pageList : "[5, 10, 20, 50, all]",
				columns : [ {
					title : '#',
					field : 'index',
					align : 'center',
					valign : 'middle',
					sortable : true
				},{
					title : '[[#{txt.project}]]',
					field : 'a',
					align : 'center',
					sortable : true,
					valign : 'middle'
				}, {
					title : '[[#{txt.date}]]',
					field : 'b',
					align : 'center',
					sortable : true,
					valign : 'middle'
				}, {
					title : '[[#{txt.item.code}]]',
					field : 'fieldName',
					align : 'center',
					sortable : true,
					valign : 'middle'
				}, {
					title : '[[#{txt.average}]]',
					field : 'median',
					align : 'right',
					sortable : true,
					valign : 'middle'
				}, {
					title : '[[#{txt.average.dev}]]',
					field : 'medianDev',
					align : 'right',
					sortable : true,
					valign : 'middle'
				}, {
					title : '[[#{txt.boxplot.top}]]',
					field : 'top',
					align : 'right',
					sortable : true,
					valign : 'middle'
				}, {
					title : '[[#{txt.boxplot.bottom}]]',
					field : 'bottom',
					align : 'right',
					sortable : true,
					valign : 'middle'
				}, {
					title : '[[#{txt.boxplot.q3}]]',
					field : 'q3',
					sortable : true,
					align : 'right'
				}, {
					title : '[[#{txt.boxplot.q1}]]',
					field : 'q1',
					align : 'center',
					sortable : true,
					valign : 'middle'	
				}, {
					title : '[[#{txt.boxplot.top}]](개발)',
					field : 'topDev',
					align : 'right',
					sortable : true,
					valign : 'middle'
				}, {
					title : '[[#{txt.boxplot.bottom}]](개발)',
					field : 'bottomDev',
					align : 'right',
					sortable : true,
					valign : 'middle'
				}, {
					title : '[[#{txt.boxplot.q3}]](개발)',
					field : 'q3Dev',
					sortable : true,
					align : 'right'
				}, {
					title : '[[#{txt.boxplot.q1}]](개발)',
					field : 'q1Dev',
					align : 'center',
					sortable : true,
					valign : 'middle'	
				}, {
					title : '[[#{txt.standard.deviation}]]',
					field : '',
					sortable : true,
					align : 'right'
				}, {
					title : '[[#{txt.standard.deviation.dev}]]',
					field : '',
					align : 'center',
					sortable : true,
					valign : 'middle'
				} ],
				onDblClickRow : function(row, $element, field) {	
				 	var data = [];	
						
				 	var boxData = [];
					var boxDataArray = [];	 			 	
				 	boxData.push(row.bottom);
				 	boxData.push(row.q1);
				 	boxData.push(row.median);
				 	boxData.push(row.q3);
				 	boxData.push(row.top);				 	
				 	boxDataArray.push(boxData)				 	
				 	var dataObj = {}
				 	dataObj.axisData = [row.b];
				 	dataObj.boxData = boxDataArray;
				 	dataObj.outliers = [];
				 	
				 	data.push(dataObj)
				 					 					 	
				 	var boxDataDev = [];
				 	var boxDataDevArray = [];
				 	boxDataDev.push(row.bottomDev);
				 	boxDataDev.push(row.q1Dev);
				 	boxDataDev.push(row.medianDev);
				 	boxDataDev.push(row.q3Dev);
				 	boxDataDev.push(row.topDev);				 	
				 	boxDataDevArray.push(boxDataDev)				 	
				 	var dataObjDev = {}
				 	dataObjDev.axisData = [row.b];
				 	dataObjDev.boxData = boxDataDevArray;
				 	dataObjDev.outliers = [];
				 	
				 	
				 	data.push(dataObjDev)
				 	
				 	
				 	var boxplotParam = {};
					boxplotParam.data = data
					boxplotParam.title = "파일 모니터링"
					boxplotParam.yAxisNm = ""	
					boxplotParam.name = ["일반", "개발"]					
					multiBoxplotModal(boxplotParam)		 
					
					
					
					// multiboxplot sample
					/*  var boxplotParam = {}			
					var boxplotData = [];
					var data0 = [
						[50, 40, -90, -170, -90, 50, -90, -90, 80, -80, -100, 90, 93, 65, 76, -810, -100, 1300, -90, 90]	           
			        ]
					var data1 = [
						[890, 840, 780, 810, 760, 810, 790, 810, 820, 850, 870, 870, 810, 740, 810, 940, 950, 800, 810, 1000]
			        ]
					var data2 = [
						[890, 840, 780, 810, 760, 810, 790, 810, 820, 850, 870, 870, 810, 740, 810, 940, 950, 800, 810, 870]
			        ]
					var data3 = [
						[890, 810, 810, 820, 800, 770, 760, 740, 750, 760, 910, 920, 890, 860, 880, 720, 840, 850, 850, 780]
			        ]
					var data4 = [
						[960, 940, 960, 940, 880, 800, 850, 880, 900, 840, 830, 790, 810, 880, 880, 830, 800, 790, 760, 1600]
			        ]
					boxplotData.push(data0)
					boxplotData.push(data1)
					boxplotData.push(data2)
					boxplotData.push(data3)
					boxplotData.push(data4)
					boxplotParam.data = boxplotData
					boxplotParam.title = "항목변화율 이력"
					boxplotParam.yAxisNm = ""	
					boxplotParam.name = ["평균", "표준편차", "중앙값", "5%", "95%"]	
					boxplotParam.color = [ utils.getColors().primary, utils.getColors().secondary ,utils.getColors().danger, utils.getColors().info ,utils.getColors().warning]			
					multiBoxplotModal(boxplotParam) */
					// multiboxplot sample

					
					
				},				
				onLoadSuccess : function() {
					
					// 임시
					var data = [
						{index: 1,a:10, b:"2020.11.11", fieldName :'test',  c:30, top:220 , q3:90, median:75 , q1:30 , bottom:10,topDev:320 , q3Dev:100, medianDev:85 , q1Dev:40 , bottomDev:20 }	
					] 
					$table.bootstrapTable('load', data)
					// 임시
				
				}
			});
			tableRefresh();
		}

		function tableRefresh() {
			bootstrapTableRefresh($table, '/api/member/getList',
					'[[${#locale}]]', '[[#{table.data.faile}]]');
		}

		function responseHandler(res) {
			$.each(res, function(i) {
				this.index = i + 1;
			});
			return res;
		}

		function callback(target, data) {

			switch (target) {
			case "PROJECT_NAMES":
				var listName = data;
				var html = "";

				$.each(listName, function(index, data) {
					html += "<option value="+data+">" + data + "</option>";
				});
				$projectNameItemDropdown.append(html);
				$projectNameItemDropdown.off();
				$projectNameItemDropdown.change(function() {
					if ($(this).val())
						fn_regdtItems($(this).val());
				});
				
				$('.picker').select2();
				
				if(!gf_IsNull(paramData)){					
					$projectNameItemDropdown.val(paramData.projectName).trigger('change');
				}
				
				break;

			case "REGDT_ITEMS":
				$regdtItemDropdown.find("option").remove();
				var html = "<option value=''>[[#{select.perform.select}]]</option>";

				$.each(data, function(index, data) {
					html += '<option value="'+data+'">' + data + '</option>';
				});
				$regdtItemDropdown.append(html);

				$regdtItemDropdown.off().change(function() {
					tableRefresh();
				});
				$('.picker').select2();
				
				if(!gf_IsNull(paramData)){					
					$regdtItemDropdown.val(paramData.regdtim).trigger('change');
				}
				break;

			default:
				break;
			}
		}
	</script>

</div>
</html>